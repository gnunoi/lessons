# Python正则表达式

## 正则表达式基础

### 定义与作用
1. 正则表达式（Regular Expression，简称Regex）是一种用于描述字符串模式的工具，能够高效实现文本匹配、搜索、替换和解析。例如：

2. 验证邮箱格式：`^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$`
3. 提取手机号：`\d{11}`

**应用场景：爬虫数据清洗、日志分析、用户输入校验等。**

### 核心语法
**元字符：具有特殊含义的字符**

1. `.`：匹配任意字符（除换行符）
2. `^`：匹配字符串开头
3.  `$`：匹配字符串结尾

4. `*`：匹配前一个字符0次或多次
5.  `+`：匹配前一个字符1次或多次

6.  `?`：匹配前一个字符0次或1次

7.  `{n,m}`：匹配前一个字符n到m次


*示例：`a{2,4}`匹配"aa"、"aaa"或"aaaa"。*

**字符类**

1. `[abc]`：匹配a、b、c中的任意一个
2. `[^abc]`：匹配除a、b、c外的任意字符

3. `\d`：等价于`[0-9]`（数字）
4. `\D`：匹配**任何非数字字符**，等价于 `[^0-9]`。
5. `\w`：等价于`[a-zA-Z0-9_]`（单词字符）
6. `\W`：匹配**任何非单词字符**，等价于 `[^a-zA-Z0-9_]`。
7. `\s`：匹配空白字符（空格、换行等），等价于`[ \t\n\r\f\v]`。
8. `\S`：匹配**任何非空白字符**，等价于 `[^ \t\n\r\f\v]`。

| 大写形式 | 对应小写形式 |    含义    | 示例匹配内容  |
| :------: | :----------: | :--------: | :-----------: |
|   `\D`   |     `\d`     |   非数字   | `A`, `$`, `%` |
|   `\W`   |     `\w`     | 非单词字符 | `!`, `@`, `_` |
|   `\S`   |     `\s`     | 非空白字符 | `a`, `1`, `#` |

**分组与捕获**

1. `(abc)`：将"abc"作为分组，可通过`group()`提取
2. `(?:abc)`：非捕获分组，仅分组不捕获

3. `(?P<name>abc)`：命名分组，通过`group('name')`获取。

### 扩展语法（零宽断言）
1. 前瞻：`(?=...)`

2. 示例：`\d+(?=%)`匹配后面跟着`%`的数字

3. 后顾：`(?<=...)`

4. 示例：`(?<=\$)\d+`匹配前面有`$`的数字

5. 否定前瞻：`(?!...)`


示例：`\d{5}(?!\d)`匹配5位数字且后面非数字。

------

## Python的`re`模块

### 常用函数

   | 函数           | 功能描述                                           | 示例                           |
   | -------------- | -------------------------------------------------- | ------------------------------ |
   | `re.match()`   | 从字符串开头匹配，返回匹配对象或`None`             | `re.match(r'\d+', '123abc')`   |
   | `re.search()`  | 在字符串中首次出现的位置匹配，返回匹配对象或`None` | `re.search(r'\d+', 'abc123')`  |
   | `re.findall()` | 返回所有匹配的子串列表                             | `re.findall(r'\d+', 'a1b2')`   |
   | `re.sub()`     | 替换匹配的子串，返回新字符串                       | `re.sub(r'\d+', 'X', 'a1b2')`  |
   | `re.split()`   | 按正则表达式分割字符串                             | `re.split(r'\.', 'a.b.c')`     |
   | `re.compile()` | 编译正则表达式为模式对象，提高重复使用效率         | `pattern = re.compile(r'\d+')` |

### 编译模式（Flags）

1. `re.IGNORECASE`（`re.I`）：忽略大小写
2. `re.MULTILINE`（`re.M`）：多行模式，`^`和`$`匹配每行首尾
3.  `re.DOTALL`（`re.S`）：`.`匹配包括换行符的所有字符

4.  `re.VERBOSE`（`re.X`）：允许正则表达式添加注释和空格。


### 匹配对象方法
1.  `group()`：获取匹配的字符串

2.  `groups()`：获取所有分组内容

3.  `start()`/`end()`：匹配的起始和结束位置

4.  `span()`：返回元组`(start, end)`。


## 实战案例

### 邮箱验证

   python

   复制

   ```python
   import re
   pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
   email = "test@example.com"
   if re.match(pattern, email):
       print("Valid email")
   ```

### 提取URL参数

   python

   复制

   ```python
   text = "https://example.com?key1=value1&key2=value2"
   params = re.findall(r'(\w+)=([^&]+)', text)
   print(params)  # [('key1', 'value1'), ('key2', 'value2')]
   ```

### 日志时间提取

   python

   复制

   ```python
   log = "2025-04-30 14:30:00 ERROR: ..."
   time = re.search(r'\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}', log).group()
   ```

## 常见问题与技巧

1. 贪婪与非贪婪匹配
 默认贪婪：`a.*b`匹配最长的`a...b`
 非贪婪：`a.*?b`匹配最短的`a...b`。

2. 转义字符处理
 正则表达式中的反斜杠需用`r""`表示原始字符串，如`r"\d+"`。

3. 性能优化
 预编译正则表达式（`re.compile()`）提升重复匹配效率。

## 总结与练习
• 总结：正则表达式是文本处理的核心工具，结合Python的`re`模块可高效实现复杂匹配逻辑。

• 练习：

1. 编写正则表达式提取HTML标签中的内容。
2. 实现一个简单的密码强度校验器（至少包含大小写字母、数字、特殊符号）。


## 参考资料
• 字符串基础与正则表达式基础概念

• Python `re`模块方法详解

• 正则表达式进阶语法与实战案例

• 正则表达式模式优化与调试技巧

